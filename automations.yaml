- id: '1642993601811'
  alias: Living Dining Room AC Set State
  description: Set the Living Dining Room AC power and temperature
  trigger:
  - platform: state
    entity_id: climate.living_dining_room_ac
    id: cooling
    to: cool
  - platform: state
    entity_id: climate.living_dining_room_ac
    id: power_off
    from: cool
  - platform: state
    entity_id: climate.living_dining_room_ac
    id: temperature_changed
    attribute: temperature
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: cooling
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Living Dining Room AC
          target_ac_temp: '{{ state_attr("climate.living_dining_room_ac", "temperature")
            }}'
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Living Dining Room AC
          target_ac_power: false
    - conditions:
      - condition: trigger
        id: temperature_changed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: climate.living_dining_room_ac
            attribute: temperature
            below: '24'
          sequence:
          - service: climate.set_temperature
            target:
              entity_id: climate.living_dining_room_ac
            data:
              temperature: 27
          - service: climate.turn_off
            target:
              entity_id: climate.living_dining_room_ac
            data: {}
          - service: script.ac_set_state
            data:
              target_ac: Living Dining Room AC
              target_ac_power: false
        default:
        - service: climate.turn_on
          target:
            entity_id: climate.living_dining_room_ac
          data: {}
        - service: script.ac_set_state
          data:
            target_ac: Living Dining Room AC
            target_ac_temp: '{{ state_attr("climate.living_dining_room_ac", "temperature")
              }}'
    default: []
  mode: single
  max_exceeded: silent
- id: '1642995603670'
  alias: Eli's Room AC Set State
  description: Set Eli's Room AC power and temperature
  trigger:
  - platform: state
    entity_id: climate.elis_room_ac
    id: cooling
    to: cool
  - platform: state
    entity_id: climate.elis_room_ac
    id: power_off
    from: cool
  - platform: state
    entity_id: climate.elis_room_ac
    id: temperature_changed
    attribute: temperature
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: cooling
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Eli's Room AC
          target_ac_temp: '{{ state_attr("climate.elis_room_ac", "temperature") }}'
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Eli's Room AC
          target_ac_power: false
    - conditions:
      - condition: trigger
        id: temperature_changed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: climate.elis_room_ac
            attribute: temperature
            below: '24'
          sequence:
          - service: climate.set_temperature
            data:
              temperature: 27
            target:
              entity_id: climate.elis_room_ac
          - service: climate.turn_off
            target:
              entity_id: climate.elis_room_ac
            data: {}
          - service: script.ac_set_state
            data:
              target_ac: Eli's Room AC
              target_ac_power: false
        default:
        - service: climate.turn_on
          target:
            entity_id: climate.elis_room_ac
          data: {}
        - service: script.ac_set_state
          data:
            target_ac: Eli's Room AC
            target_ac_temp: '{{ state_attr("climate.elis_room_ac", "temperature")
              }}'
    default: []
  mode: single
  max_exceeded: silent
- id: '1642996756359'
  alias: Elena's Room AC Set State
  description: Set Elena's Room AC power and temperature
  trigger:
  - platform: state
    entity_id: climate.elenas_room_ac
    id: cooling
    to: cool
  - platform: state
    entity_id: climate.elenas_room_ac
    id: power_off
    from: cool
  - platform: state
    entity_id: climate.elenas_room_ac
    id: temperature_changed
    attribute: temperature
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: cooling
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Elena's Room AC
          target_ac_temp: '{{ state_attr("climate.elenas_room_ac", "temperature")
            }}'
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: script.ac_set_state
        data:
          target_ac: Elena's Room AC
          target_ac_power: false
    - conditions:
      - condition: trigger
        id: temperature_changed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: climate.elenas_room_ac
            attribute: temperature
            below: '24'
          sequence:
          - service: climate.set_temperature
            target:
              entity_id: climate.elenas_room_ac
            data:
              temperature: 27
          - service: climate.turn_off
            target:
              entity_id: climate.elenas_room_ac
            data: {}
          - service: script.ac_set_state
            data:
              target_ac: Elena's Room AC
              target_ac_power: false
        default:
        - service: climate.turn_on
          target:
            entity_id: climate.elenas_room_ac
          data: {}
        - service: script.ac_set_state
          data:
            target_ac: Elena's Room AC
            target_ac_temp: '{{ state_attr("climate.elenas_room_ac", "temperature")
              }}'
    default: []
  mode: single
  max_exceeded: silent
- id: '1642997460354'
  alias: Dining Room Fan Set State
  description: Set Dining Room Fan power and speed
  trigger:
  - platform: state
    entity_id: fan.dining_room_fan
    id: power_off
    from: 'on'
    to: 'off'
  - platform: state
    entity_id: fan.dining_room_fan
    id: power_on
    from: 'off'
    to: 'on'
  - platform: state
    entity_id: fan.dining_room_fan
    id: speed
    attribute: percentage
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: speed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: fan.dining_room_fan
            attribute: percentage
            below: '10'
          sequence:
          - service: fan.set_percentage
            data:
              percentage: 66
            target:
              entity_id: fan.dining_room_fan
          - service: fan.turn_off
            data: {}
            target:
              entity_id: fan.dining_room_fan
          - service: script.fan_set_state
            data:
              target_fan: Dining Room Fan
              target_fan_power: false
        default:
        - service: script.fan_set_state
          data:
            target_fan: Dining Room Fan
            target_fan_speed: '{{ state_attr("fan.dining_room_fan", "percentage")
              | int }}'
    - conditions:
      - condition: trigger
        id: power_on
      sequence:
      - service: fan.set_percentage
        data:
          percentage: 66
        target:
          entity_id: fan.dining_room_fan
      - service: script.fan_set_state
        data:
          target_fan: Dining Room Fan
          target_fan_speed: '{{ state_attr("fan.dining_room_fan", "percentage") |
            int }}'
          target_fan_power: true
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.dining_room_fan_power
      - service: script.fan_set_state
        data:
          target_fan: Dining Room Fan
          target_fan_power: false
    default: []
  mode: single
- id: '1642998485292'
  alias: Eli's Room Fan Set State
  description: Set Eli's Room Fan power and speed
  trigger:
  - platform: state
    entity_id: fan.elis_room_fan
    id: power_off
    from: 'on'
    to: 'off'
  - platform: state
    entity_id: fan.elis_room_fan
    id: power_on
    from: 'off'
    to: 'on'
  - platform: state
    entity_id: fan.elis_room_fan
    attribute: percentage
    id: speed
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: speed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: fan.elis_room_fan
            attribute: percentage
            below: '10'
          sequence:
          - service: fan.set_percentage
            data:
              percentage: '{{ state_attr("binary_sensor.recommended_scene_in_elis_room",
                "fan_speed") | int }}'
            target:
              entity_id: fan.elis_room_fan
          - service: fan.turn_off
            data: {}
            target:
              entity_id: fan.elis_room_fan
          - service: script.fan_set_state
            data:
              target_fan: Eli's Room Fan
              target_fan_power: false
        default:
        - service: script.fan_set_state
          data:
            target_fan: Eli's Room Fan
            target_fan_speed: '{{ state_attr("fan.elis_room_fan", "percentage") |
              int }}'
    - conditions:
      - condition: trigger
        id: power_on
      sequence:
      - service: fan.set_percentage
        data:
          percentage: '{{ state_attr("binary_sensor.recommended_scene_in_elis_room",
            "fan_speed") | int }}'
        target:
          entity_id: fan.elis_room_fan
      - service: script.fan_set_state
        data:
          target_fan: Eli's Room Fan
          target_fan_speed: '{{ state_attr("fan.elis_room_fan", "percentage") | int
            }}'
          target_fan_power: true
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.elis_room_fan_power
      - service: script.fan_set_state
        data:
          target_fan: Eli's Room Fan
          target_fan_power: false
    default: []
  mode: single
- id: '1643000778073'
  alias: Elena's Room Fan Set State
  description: Set Elena's Room Fan power and speed
  trigger:
  - platform: state
    entity_id: fan.elenas_room_fan
    id: power_off
    from: 'on'
    to: 'off'
  - platform: state
    entity_id: fan.elenas_room_fan
    id: power_on
    from: 'off'
    to: 'on'
  - platform: state
    entity_id: fan.elenas_room_fan
    id: speed
    attribute: percentage
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: speed
      sequence:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: fan.elenas_room_fan
            attribute: percentage
            below: '10'
          sequence:
          - service: fan.set_percentage
            data:
              percentage: '{{ state_attr("binary_sensor.recommended_scene_in_elenas_room",
                "fan_speed") | int }}'
            target:
              entity_id: fan.elenas_room_fan
          - service: fan.turn_off
            data: {}
            target:
              entity_id: fan.elenas_room_fan
          - service: script.fan_set_state
            data:
              target_fan: Elena's Room Fan
              target_fan_power: false
        default:
        - service: script.fan_set_state
          data:
            target_fan: Elena's Room Fan
            target_fan_speed: '{{ state_attr("fan.elenas_room_fan", "percentage")
              | int }}'
    - conditions:
      - condition: trigger
        id: power_on
      sequence:
      - service: fan.set_percentage
        data:
          percentage: '{{ state_attr("binary_sensor.recommended_scene_in_elenas_room",
            "fan_speed") | int }}'
        target:
          entity_id: fan.elenas_room_fan
      - service: script.fan_set_state
        data:
          target_fan: Elena's Room Fan
          target_fan_speed: '{{ state_attr("fan.elenas_room_fan", "percentage") |
            int }}'
          target_fan_power: true
    - conditions:
      - condition: trigger
        id: power_off
      sequence:
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.elenas_room_fan_power
      - service: script.fan_set_state
        data:
          target_fan: Elena's Room Fan
          target_fan_power: false
    default: []
  mode: single
  max_exceeded: silent
- id: '1643640720985'
  alias: Dining Room Lights Controller 1
  description: Control the Dining Room Lights
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 0df2cd0b0fa9112188778c56db622911
      helper_last_controller_event: input_text.zz_dining_room_lights_controller_1_last_event
      action_button_up_short:
      - service: light.turn_on
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data:
          brightness_pct: 100
      action_button_up_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data:
          brightness_step_pct: 10
      action_button_down_short:
      - service: light.turn_off
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data: {}
      action_button_down_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data:
          brightness_step_pct: -10
      button_up_long_loop: true
      button_up_long_max_loop_repeats: 50
      button_down_long_loop: true
      button_down_long_max_loop_repeats: 50
      action_button_down_double:
      - service: script.turn_off_all
        data: {}
      button_down_double_press: true
      helper_double_press_delay: 1000
- id: '1643641285314'
  alias: Dining Room Lights Controller 2
  description: Control the Dining Room Lights
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: cea5083fc6a1972a0b57048ffa03cfd8
      helper_last_controller_event: input_text.zz_dining_room_lights_controller_2_last_event
      action_button_up_short:
      - choose:
        - conditions:
          - condition: time
            after: input_datetime.wind_down
            before: input_datetime.lights_auto_control_end
          sequence:
          - service: light.turn_on
            target:
              entity_id:
              - light.dining_room_lights
              - light.dining_room_pendant_light_entity
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id:
            - light.dining_room_lights
            - light.dining_room_pendant_light_entity
          data:
            brightness_pct: 98
      action_button_up_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data:
          brightness_step_pct: 10
      action_button_down_short:
      - service: light.turn_off
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data: {}
      action_button_down_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.dining_room_lights
          - light.dining_room_pendant_light_entity
        data:
          brightness_step_pct: -10
      button_up_long_max_loop_repeats: 50
      button_down_long_max_loop_repeats: 50
      button_down_long_loop: true
      button_up_long_loop: true
- id: '1643641631013'
  alias: Playroom Lights Controller
  description: Control the Playroom Lights
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 867b78e6f7808ffcceb260be52b0c174
      helper_last_controller_event: input_text.zz_playroom_lights_controller_last_event
      action_button_up_short:
      - choose:
        - conditions:
          - condition: time
            before: input_datetime.lights_auto_control_end
            after: input_datetime.wind_down
          sequence:
          - service: light.turn_on
            target:
              entity_id:
              - light.playroom_lights
              - light.yard_light_entity
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id:
            - light.playroom_lights
            - light.yard_light_entity
          data:
            brightness_pct: 100
      action_button_up_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.playroom_lights
          - light.yard_light_entity
        data:
          brightness_step_pct: 10
      action_button_down_short:
      - service: light.turn_off
        target:
          entity_id:
          - light.playroom_lights
          - light.yard_light_entity
        data: {}
      action_button_down_long:
      - service: light.turn_on
        target:
          entity_id:
          - light.playroom_lights
          - light.yard_light_entity
        data:
          brightness_step_pct: -10
      button_up_long_max_loop_repeats: 50
      button_down_long_max_loop_repeats: 50
      button_down_long_loop: true
      button_up_long_loop: true
- id: '1643642352545'
  alias: Playroom Motion
  description: Control the Playroom Lights with Motion
  trigger:
  - platform: state
    entity_id: binary_sensor.playroom_motion
    id: motion
    from: 'off'
    to: 'on'
  - platform: state
    entity_id: binary_sensor.playroom_motion
    id: no_motion
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: motion
      sequence:
      - condition: state
        entity_id: switch.lights_auto_control
        state: 'on'
      - choose:
        - conditions:
          - condition: time
            before: input_datetime.lights_auto_control_end
            weekday:
            - mon
            - tue
            - wed
            - thu
            - fri
            - sat
            - sun
            after: input_datetime.wind_down
          sequence:
          - service: light.turn_on
            target:
              entity_id:
              - light.playroom_lights
              - light.yard_light_entity
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id:
            - light.playroom_lights
            - light.yard_light_entity
          data:
            brightness_pct: 100
    - conditions:
      - condition: trigger
        id: no_motion
      sequence:
      - service: light.turn_off
        target:
          entity_id:
          - light.playroom_lights
          - light.yard_light_entity
        data: {}
    default: []
  mode: single
- id: '1643642651826'
  alias: Hallway Motion
  description: Control the Hallway Lights with motion
  trigger:
  - platform: state
    entity_id: binary_sensor.hallway_motion
    id: motion
    from: 'off'
    to: 'on'
  - platform: state
    entity_id: binary_sensor.hallway_motion
    id: no_motion
    from: 'on'
    to: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: motion
      sequence:
      - condition: state
        entity_id: switch.lights_auto_control
        state: 'on'
      - choose:
        - conditions:
          - condition: time
            after: input_datetime.elenas_wind_down
            before: input_datetime.lights_auto_control_end
          sequence:
          - service: light.turn_on
            target:
              entity_id: light.hallway_lights
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id: light.hallway_lights
          data:
            brightness_pct: 100
    - conditions:
      - condition: trigger
        id: no_motion
      sequence:
      - service: light.turn_off
        target:
          entity_id: light.hallway_lights
    default: []
  mode: single
- id: '1643643181661'
  alias: Living Dining Room AC Controller 1
  description: Control the Living Dining Room AC
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 6e3bab771f635d9d237ea94a56bbf115
      helper_last_controller_event: input_text.zz_living_dining_room_ac_controller_1_last_event
      action_button_up_short:
      - service: climate.turn_on
        target:
          entity_id: climate.living_dining_room_ac
      action_button_up_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.living_dining_room_ac
        data:
          temperature: "{% if state_attr('climate.living_dining_room_ac', 'temperature')\
            \ < 27 %}\n  {{ state_attr('climate.living_dining_room_ac', 'temperature')\
            \ + 1 }}\n{% else %}\n  27\n{% endif %}\n"
      action_button_down_short:
      - service: climate.turn_off
        target:
          entity_id: climate.living_dining_room_ac
      action_button_down_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.living_dining_room_ac
        data:
          temperature: "{% if state_attr('climate.living_dining_room_ac', 'temperature')\
            \ > 24 %}\n  {{ state_attr('climate.living_dining_room_ac', 'temperature')\
            \ - 1 }}\n{% else %}\n  24\n{% endif %}\n"
- id: '1643643631965'
  alias: Dining Room Fan Controller
  description: Control the Dining Room Fan
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 2c65aa31e07cc74bcef34dfa0d22d784
      helper_last_controller_event: input_text.zz_dining_room_fan_controller_last_event
      action_button_up_short:
      - service: fan.turn_on
        target:
          entity_id: fan.dining_room_fan
        data: {}
      action_button_down_short:
      - service: fan.turn_off
        target:
          entity_id: fan.dining_room_fan
        data: {}
      action_button_down_long:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: fan.dining_room_fan
            attribute: percentage
            below: '20'
          sequence:
          - service: fan.turn_off
            data: {}
            target:
              entity_id: fan.dining_room_fan
        default:
        - service: fan.decrease_speed
          data: {}
          target:
            entity_id: fan.dining_room_fan
      action_button_up_long:
      - service: fan.increase_speed
        target:
          entity_id: fan.dining_room_fan
        data: {}
- id: '1643644178195'
  alias: Powder Room Lights Controller
  description: Control the Powder Room Lights
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 8fd4f8715be89cc0f383c887c3fac892
      helper_last_controller_event: input_text.zz_powder_room_lights_controller_last_event
      action_button_up_short:
      - choose:
        - conditions:
          - condition: time
            after: input_datetime.wind_down
            before: input_datetime.lights_auto_control_end
          sequence:
          - service: light.turn_on
            target:
              entity_id: light.powder_room_pendant_light_entity
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id: light.powder_room_pendant_light_entity
          data:
            brightness_pct: 100
      action_button_up_long:
      - service: light.turn_on
        target:
          entity_id: light.powder_room_pendant_light_entity
        data:
          brightness_step_pct: 10
      action_button_down_short:
      - service: light.turn_off
        target:
          entity_id: light.powder_room_pendant_light_entity
        data: {}
      action_button_down_long:
      - service: light.turn_on
        target:
          entity_id: light.powder_room_pendant_light_entity
        data:
          brightness_step_pct: -10
      button_up_long_loop: true
      button_up_long_max_loop_repeats: 50
      button_down_long_loop: true
      button_down_long_max_loop_repeats: 50
- id: '1643644997118'
  alias: Eli's Room Fan Controller
  description: Control Eli's Room Fan
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: f70176647fea31ee95539e565e16e9be
      helper_last_controller_event: input_text.zz_eli_s_room_fan_controller_last_event
      action_button_up_short:
      - service: fan.turn_on
        target:
          entity_id: fan.elis_room_fan
        data: {}
      action_button_up_long:
      - service: fan.increase_speed
        target:
          entity_id: fan.elis_room_fan
        data: {}
      action_button_down_short:
      - service: fan.turn_off
        target:
          entity_id: fan.elis_room_fan
        data: {}
      action_button_down_long:
      - choose:
        - conditions:
          - condition: numeric_state
            entity_id: fan.elis_room_fan
            attribute: percentage
            below: '20'
          sequence:
          - service: fan.turn_off
            data: {}
            target:
              entity_id: fan.elis_room_fan
        default:
        - service: fan.decrease_speed
          data: {}
          target:
            entity_id: fan.elis_room_fan
- id: '1643645192684'
  alias: Eli's Room AC Controller
  description: Control Eli's Room AC
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 729379c869fac5a454929998eba2f3d2
      helper_last_controller_event: input_text.zz_eli_s_room_ac_controller_last_event
      action_button_up_short:
      - service: climate.turn_on
        target:
          entity_id: climate.elis_room_ac
      action_button_up_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elis_room_ac
        data:
          temperature: "{% if state_attr('climate.elis_room_ac', 'temperature') <\
            \ 27 %}\n  {{ state_attr('climate.elis_room_ac', 'temperature') + 1 }}\n\
            {% else %}\n  27\n{% endif %}\n"
      action_button_down_short:
      - service: climate.turn_off
        target:
          entity_id: climate.elis_room_ac
      action_button_down_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elis_room_ac
        data:
          temperature: "{% if state_attr('climate.elis_room_ac', 'temperature') >\
            \ 24 %}\n  {{ state_attr('climate.elis_room_ac', 'temperature') 1 1 }}\n\
            {% else %}\n  24\n{% endif %}\n"
- id: '1643645339926'
  alias: Eli's Room AC Controller
  description: Control Eli's Room AC
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 729379c869fac5a454929998eba2f3d2
      action_button_up_short:
      - service: climate.turn_on
        target:
          entity_id: climate.elis_room_ac
      action_button_up_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elis_room_ac
        data:
          temperature: "{% if state_attr('climate.elis_room_ac', 'temperature') <\
            \ 27 %}\n  {{ state_attr('climate.elis_room_ac', 'temperature') + 1 }}\n\
            {% else %}\n  27\n{% endif %}\n"
      action_button_down_short:
      - service: climate.turn_off
        target:
          entity_id: climate.elis_room_ac
      action_button_down_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elis_room_ac
        data:
          temperature: "{% if state_attr('climate.elis_room_ac', 'temperature') >\
            \ 24 %}\n  {{ state_attr('climate.elis_room_ac', 'temperature') - 1 }}\n\
            {% else %}\n  24\n{% endif %}\n"
      helper_last_controller_event: input_text.zz_eli_s_room_ac_controller_last_event
- id: '1643645667838'
  alias: Eli's Room Lights Controller
  description: Control Eli's Room Lights
  use_blueprint:
    path: niro1987/zha_ikea_tradfri_5button_remote_white.yaml
    input:
      remote: 4f9d115057150510080b9cde7008bb35
      light: light.elis_room_lights
- id: '1643645804516'
  alias: Elena's Room Fan Controller
  description: Control Elena's Room Fan
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: ea611248af61d7f5dc06e3a824288132
      helper_last_controller_event: input_text.zz_elena_s_room_fan_controller_last_event
      action_button_up_short:
      - service: fan.turn_on
        target:
          entity_id: fan.elenas_room_fan
        data: {}
      action_button_up_long:
      - service: fan.increase_speed
        target:
          entity_id: fan.elenas_room_fan
        data: {}
      action_button_down_short:
      - service: fan.turn_off
        target:
          entity_id: fan.elenas_room_fan
        data: {}
      action_button_down_long:
      - service: fan.decrease_speed
        data: {}
        target:
          entity_id: fan.elenas_room_fan
- id: '1643646271389'
  alias: Elena's Room AC Controller
  description: Control Elena's Room AC
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: 4992a43f1eecbf448ac02a3c2601ab36
      helper_last_controller_event: input_text.zz_elena_s_room_ac_controller_last_event
      action_button_up_short:
      - service: climate.turn_on
        target:
          entity_id: climate.elenas_room_ac
      action_button_up_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elenas_room_ac
        data:
          temperature: "{% if state_attr('climate.elenas_room_ac', 'temperature')\
            \ < 27 %}\n  {{ state_attr('climate.elenas_room_ac', 'temperature') +\
            \ 1 }}\n{% else %}\n  27\n{% endif %}\n"
      action_button_down_short:
      - service: climate.turn_off
        target:
          entity_id: climate.elenas_room_ac
      action_button_down_long:
      - service: climate.set_temperature
        target:
          entity_id: climate.elenas_room_ac
        data:
          temperature: "{% if state_attr('climate.elenas_room_ac', 'temperature')\
            \ > 24 %}\n  {{ state_attr('climate.elenas_room_ac', 'temperature') -\
            \ 1 }}\n{% else %}\n  24\n{% endif %}\n"
- id: '1643646541355'
  alias: Junior Bathroom Lights Controller
  description: Control the Junior Bathroom Lights
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: ZHA
      controller_device: f084f2e55c0800941585a50dd83e5f47
      helper_last_controller_event: input_text.zz_junior_bathroom_lights_controller_last_event
      action_button_up_short:
      - choose:
        - conditions:
          - condition: time
            after: input_datetime.elenas_bedtime
            before: input_datetime.lights_auto_control_end
          sequence:
          - service: light.turn_on
            target:
              entity_id: light.junior_bathroom_lights
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id: light.junior_bathroom_lights
          data:
            brightness_pct: 100
      action_button_up_long:
      - service: light.turn_on
        target:
          entity_id: light.junior_bathroom_lights
        data:
          brightness_step_pct: 10
      action_button_down_short:
      - service: light.turn_off
        target:
          entity_id: light.junior_bathroom_lights
      action_button_down_long:
      - service: light.turn_on
        target:
          entity_id: light.junior_bathroom_lights
        data:
          brightness_step_pct: -10
      button_up_long_loop: true
      button_up_long_max_loop_repeats: 50
      button_down_long_loop: true
      button_down_long_max_loop_repeats: 50
- id: '1643710058122'
  alias: Elena's Room AC Auto Control
  description: Automatically turn of or off Elena's Room AC to keep Elena's Room Temperature
    within +1.2 and +0.2 degC of the AC target temperature
  trigger:
  - platform: state
    entity_id: sensor.elenas_room_temperature
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.elenas_room_temperature
        value_template: '{{ float(state.state) - state_attr(''climate.elenas_room_ac'',
          ''temperature'') | int }}'
        above: '1.2'
      - condition: state
        entity_id: climate.elenas_room_ac
        state: 'off'
      sequence:
      - service: climate.turn_on
        target:
          entity_id: climate.elenas_room_ac
        data: {}
    - conditions:
      - condition: numeric_state
        entity_id: sensor.elenas_room_temperature
        below: '0.2'
        value_template: '{{ float(state.state) - state_attr(''climate.elenas_room_ac'',
          ''temperature'') | int }}'
      - condition: state
        entity_id: climate.elenas_room_ac
        state: cool
      sequence:
      - service: climate.turn_off
        target:
          entity_id: climate.elenas_room_ac
        data: {}
    default: []
  mode: single
- id: '1643710293194'
  alias: Eli's Room AC Auto Control
  description: Automatically turn of or off Eli's Room AC to keep Eli's Room Temperature
    within +1.2 and +0.2 degC of the AC target temperature
  trigger:
  - platform: state
    entity_id: sensor.elis_room_temperature
  condition: []
  action:
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.elis_room_temperature
        above: '1.2'
        value_template: '{{ float(state.state) - state_attr("climate.elis_room_ac",
          "temperature") | int }}'
      - condition: state
        entity_id: climate.elis_room_ac
        state: 'off'
      sequence:
      - service: climate.turn_on
        target:
          entity_id: climate.elis_room_ac
        data: {}
    - conditions:
      - condition: numeric_state
        entity_id: sensor.elis_room_temperature
        below: '0.2'
        value_template: '{{ float(state.state) - state_attr("climate.elis_room_ac",
          "temperature") | int }}'
      - condition: state
        entity_id: climate.elis_room_ac
        state: cool
      sequence:
      - service: climate.turn_off
        target:
          entity_id: climate.elis_room_ac
        data: {}
    default: []
  mode: single
- id: '1643721003621'
  alias: AC Auto Control at Night
  description: Turn on AC Auto Control at night in rooms where fans are on
  trigger:
  - platform: time
    id: start
    at: input_datetime.ac_auto_control_start
  - platform: time
    at: input_datetime.ac_auto_control_end
    id: end
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: end
      sequence:
      - service: automation.turn_off
        target:
          entity_id:
          - automation.elenas_room_ac_auto_control
          - automation.elis_room_ac_auto_control
      - service: climate.turn_off
        target:
          entity_id:
          - climate.elenas_room_ac
          - climate.elis_room_ac
    - conditions:
      - condition: trigger
        id: start
      sequence:
      - choose:
        - conditions:
          - condition: state
            entity_id: fan.elenas_room_fan
            state: 'on'
          sequence:
          - service: automation.turn_on
            target:
              entity_id: automation.elenas_room_ac_auto_control
        default: []
      - choose:
        - conditions:
          - condition: state
            entity_id: fan.elis_room_fan
            state: 'on'
          sequence:
          - service: automation.turn_on
            target:
              entity_id: automation.elis_room_ac_auto_control
        default: []
    default: []
  mode: single
- id: '1643973685368'
  alias: Notify When Vacuum Undocked
  description: Send a persistent notification if the vacuum is undocked and idle and
    dismiss it when it stops being idle
  trigger:
  - platform: state
    entity_id: vacuum.pikachu
    id: idle
    to: idle
  - platform: state
    entity_id: vacuum.pikachu
    id: not_idle
    from: idle
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: idle
      sequence:
      - service: notify.mobile_app_pixel_4a
        data:
          message: Vacuum not docked properly
          title: Please manually dock vacuum
          data:
            persistent: true
            tag: vacuum_undocked
      - service: notify.mobile_app_grace
        data:
          message: Vacuum not docked properly
          title: Please manually dock vacuum
          data:
            tag: vacuum_undocked
    - conditions:
      - condition: trigger
        id: not_idle
      sequence:
      - service: notify.mobile_app_pixel_4a
        data:
          message: clear_notification
          data:
            tag: vacuum_undocked
      - service: notify.mobile_app_grace
        data:
          message: clear_notification
          data:
            tag: vacuum_undocked
    default: []
  mode: single
- id: '1643979293415'
  alias: Notify When AC On With Doors Open
  description: Send a persistent notification when AC is on with doors open, and clear
    notification when no AC is on with doors open
  trigger:
  - platform: state
    entity_id: binary_sensor.ac_on_with_doors_open
    id: notify
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - platform: state
    entity_id: binary_sensor.ac_on_with_doors_open
    id: clear
    from: 'on'
    to: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: notify
      sequence:
      - service: notify.mobile_app_pixel_4a
        data:
          message: AC on with doors open
          title: Please close the doors
          data:
            persistent: true
            tag: doors_open
      - service: notify.mobile_app_grace
        data:
          message: AC on with doors open
          title: Please close the doors
          data:
            tag: doors_open
    - conditions:
      - condition: trigger
        id: clear
      sequence:
      - service: notify.mobile_app_pixel_4a
        data:
          message: clear_notification
          data:
            tag: doors_open
      - service: notify.mobile_app_grace
        data:
          message: clear_notification
          data:
            tag: doors_open
    default: []
  mode: single
- id: '1643979577174'
  alias: Notify When Wash Completed
  description: Send notification when washer is finished
  trigger:
  - platform: state
    entity_id: binary_sensor.washer_wash_completed
    from: 'off'
    to: 'on'
  condition: []
  action:
  - service: notify.mobile_app_pixel_4a
    data:
      title: Please unload laundry
      message: Wash completed at {{ (now() | string)[11:16] }}
  - service: notify.mobile_app_grace
    data:
      title: Please unload laundry
      message: Wash completed at {{ (now() | string)[11:16] }}
  mode: single
- id: '1644145378905'
  alias: Powder Room Motion
  description: Control the Powder Room Lights with motion
  trigger:
  - platform: state
    entity_id: binary_sensor.powder_room_motion
    id: motion
    to: 'on'
  - platform: state
    entity_id: binary_sensor.powder_room_motion
    id: no_motion
    to: 'off'
    for:
      hours: 0
      minutes: 15
      seconds: 0
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: motion
      sequence:
      - choose:
        - conditions:
          - condition: time
            before: input_datetime.lights_auto_control_end
            after: input_datetime.sleep_hours_start
          sequence:
          - service: light.turn_on
            target:
              entity_id: light.powder_room_pendant_light_entity
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id: light.powder_room_pendant_light_entity
          data:
            brightness_pct: 100
    - conditions:
      - condition: trigger
        id: no_motion
      sequence:
      - service: light.turn_off
        target:
          entity_id: light.powder_room_pendant_light_entity
    default: []
  mode: single
- id: '1644147041887'
  alias: Junior Bathroom Motion
  description: Control the Junior Bathroom lights with motion
  trigger:
  - platform: state
    entity_id: binary_sensor.junior_bathroom_motion
    id: motion
    to: 'on'
  - platform: state
    entity_id: binary_sensor.junior_bathroom_motion
    id: no_motion
    to: 'off'
    for:
      hours: 0
      minutes: 15
      seconds: 0
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: motion
      sequence:
      - choose:
        - conditions:
          - condition: time
            after: input_datetime.elenas_bedtime
            before: input_datetime.lights_auto_control_end
          sequence:
          - service: light.turn_on
            target:
              entity_id: light.junior_bathroom_lights
            data:
              brightness_pct: 5
        default:
        - service: light.turn_on
          target:
            entity_id: light.junior_bathroom_lights
          data:
            brightness_pct: 100
    - conditions:
      - condition: trigger
        id: no_motion
      sequence:
      - service: light.turn_off
        target:
          entity_id: light.junior_bathroom_lights
    default: []
  mode: single
- id: '1644478273862'
  alias: Lights Auto Control at Night
  description: Turn on Lights Auto Control at night
  trigger:
  - platform: time
    id: start
    at: input_datetime.lights_auto_control_start
  - platform: time
    id: end
    at: input_datetime.lights_auto_control_end
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: start
      sequence:
      - service: switch.turn_on
        target:
          entity_id: switch.lights_auto_control
    - conditions:
      - condition: trigger
        id: end
      sequence:
      - service: switch.turn_off
        target:
          entity_id: switch.lights_auto_control
    default: []
  mode: single
- id: '1648365105505'
  alias: Elena's Room Lights Controller
  description: Control Elena's Room Lights
  use_blueprint:
    path: niro1987/zha_ikea_tradfri_5button_remote_white.yaml
    input:
      remote: 4887aacb6003bfff53e588f01fce030f
      light: light.elenas_room_lights
